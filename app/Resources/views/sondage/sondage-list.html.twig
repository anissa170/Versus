{% extends 'layout.html.twig' %}

{% block content %}
	<!--CREATION DE SONDAGE-->
	<div class="row"  id="gray-color" style="height:100%;">

		<div class="container">

			<article class="col s6 m6 l4" >
				<div class="card small white " style="border:dotted;">
					<div class="card-content wite-text gray" >
						<a class="center btn-floating btn-large waves-effect waves-light deep-purple lighten-2" href="{{ path('addSondage') }}" style="margin-top:30%;margin-left:40%;" >
							<i class="material-icons">add</i>
						</a>
					</div>
				</div>
			</article>

			<!----------AFFICHAGE SONDAGE---------->

			<!--Block 1-->

            {% for sondage in sondages %}
			<article class="col s6 m6 l4">
				<div class="card small white">
					<div class="card-content wite-text">
						<span class="card-title">{{ sondage.titre }}</span>
					</div>

					<div class="card-content wite-text " >
						<div class="center-align">
							<p>Carte : {{ sondage.carte.nom }}</p> <!-- Nom de la carte -->
							<p>{{ sondage.propositions|length }} Propositions</p> <!-- Nombre de réponses -->

                            {% set totalReponse = 0 %}
                            {% for proposition in sondage.propositions %}
                                {% set totalReponse = totalReponse + proposition.reponses|length %}
                            {% endfor %}

							<p>{{ totalReponse }} Réponse(s)</p>
							<br/>

							<!-- Switch -->

							<div class="switch" >
								<label>
									Off
									{% if sondage.publier %}
									    <input onclick="switchPublication({{ sondage.id }})" checked type="checkbox">
                                    {% else %}
                                        <input onclick="switchPublication({{ sondage.id }})" type="checkbox">
                                    {% endif %}
									<span class="lever"></span>
									Publié
								</label>
							</div>
						</div>
					</div>

					<div class="card-action deep-purple lighten-2"  >
						<div class="center-align" >
							<a href="#"> <i class="material-icons" style="color:black;" >mode_edit</i></a>
							<a href="{{ path('showSondage', {id: sondage.id}) }}"><i class="material-icons" style="color:black;">remove_red_eye</i></a>
							<a href="{{ path('deleteSondage', {id: sondage.id}) }}"><i class="material-icons" style="color:black;">delete_forever</i></a>
							<a href="#"><i class="material-icons" style="color:black;">share</i></a>
						</div>
					</div>
				</div>
			</article>
            {% endfor %}

		</div>
	</div>
{% endblock %}

{% block stylesheets %}
    {{ parent() }}
	<style>
		#color-purple{
			background-color: #8f7cbc;
		}

		#logo-versus{
			height:400px;
			margin-top:-140px;
			margin-left:-250px;
		}
		#text-logo{
			margin-top:30px;
			margin-left:155px;
		}

		#text-titre{
			margin-top:30px;
		}

		#gray-color{
			background-color:#f5f5f5;
		}

		#bloc-gauche{
			margin-left:50px;
			margin-top:60px;
			position:relative;
		}
		#bloc-image{
			border:solid;
			width:220px;
			height:220px;
		}

		#button-upload{
			background-color:#9e9e9e;
			font-size:14px;
			position:absolute;
		}
		#file-url{
			width:350px;
			position:absolute;

		}

		#card-menu{
			background-color:white;
			color:black;
			margin-top:70px;
			width:250px;
			font-size:14px;
		}

		#form-bloc{
			margin-top:40px;
			position:relative;
		}

		#margin-rightSide{
			margin-right:30px;
		}

		#username_css{
			margin-right:30px;
		}

		#logo-user{
			margin-right:30px;
		}

		body {

			flex-direction: column;


		}

		.row{
			margin-bottom: 0px;
			margin-top: -20px;

		}
	</style>
{% endblock %}

{% block javascripts %}
    {{ parent() }}
	<script type="text/javascript"></script>
	<script type="text/javascript">
        $(".dropdown-button").dropdown();

        (function($) {
            $(function() {
                $('.dropdown-button').dropdown({
                    inDuration: 300,
                    outDuration: 225,
                    hover: true, // Activate on hover
                    belowOrigin: true, // Displays dropdown below the button
                    alignment: 'right' // Displays dropdown with edge aligned to the left of button
                });
            }); // End Document Ready
        })(jQuery); // End of jQuery name space

        function switchPublication(id) {
            $.post("{{ path('publierSondage') }}",
                {
                    id: id
                },
                function(data, status){
                    console.log("Data: " + data + "\nStatus: " + status);
                });
        }
	</script>
{% endblock %}